/**
 *  Restify v0.2.2
 *  (c) 2013 Ilan Frumer
 *  License: MIT
 */

(function(){var a;a=angular.module("restify",[]),a.config(["$httpProvider",function(a){return data.transformRequest=a.defaults.transformRequest[0],data.transformResponse=a.defaults.transformResponse[0]}]),a.factory("restify",["$http","$q",function(a,b){var c,d,e,f,g;return g=function(a){return _.filter(a.split("/"),function(a){return a})},f=function(a){return _.omit(a,function(a,b){return/^\$/.test(b)||a&&a instanceof c})},e=function(a,c){var d,e,g,h,i;for(d={},d.url=this.$$url,d.method=a,angular.isUndefined(c)||(d.data=angular.toJson(f(c))),h=[],i=this;i;)h.push(i),i=i.$$parent;return e=_.find(h,"$$requestInterceptor"),g=_.find(h,"$$responseInterceptor"),d.transformRequest=function(a){return a=c.transformRequest(a),angular.isUndefined(e)||(a=e.$$requestInterceptor(a)),a||b.when(a)},d.transformResponse=function(a,c){return a=a.transformResponse(a,c),angular.isUndefined(g)||(a=g.$$responseInterceptor(a,c)),a||b.when(a)},d.headers=_.reduceRight(h,function(a,b){return _.defaults(a,b.$$headers||{})},{}),d},d=function(a,c){var d;return d=b.defer(),a.success(function(a){return angular.isUndefined(c)||(a=c(a)),d.resolve(a)}),a.error(function(a){return d.reject(a)}),d.promise},c=function(){function b(a,c,d){var e,f,g;this.$$url=a,this.$$route=c,this.$$parent=d;for(f in c)g=c[f],"/"===a&&(a=""),/^:/.test(f)?(e=f.match(/^:(.+)/)[1],this["$"+e]=function(c){return new b(""+a+"/"+c,g,this)}):this[f]=new b(""+a+"/"+f,g,this)}return b.prototype.$uget=function(a){return null==a&&(a={}),this.get(a,!1)},b.prototype.$get=function(c,f){var g,h=this;return null==c&&(c={}),null==f&&(f=!0),g=e.call(this,"GET"),_.isEmpty(c)||(g.params=c),d(a(g),function(a){var c,d,e,g,i,j;if(!f)return a;if(g=new b(h.$$url,h.$$route,h.$$parent),_.isArray(a)){c=void 0,d=h.$$route,j=h.$$route;for(e in j)if(i=j[e],/^:/.test(e)){c=e.match(/^:(.+)/)[1],d=i;break}angular.isUndefined(c)||(a=_.map(a,function(a){return angular.isUndefined(a[c])?a:_.extend(new b(""+g.$$url+"/"+a[c],d,g),a)}))}return _.extend(g,a)})},b.prototype.$delete=function(){var b;return b=e.call(this,"DELETE"),d(a(b))},b.prototype.$post=function(b){var c;return c=e.call(this,"POST",b||this),d(a(c))},b.prototype.$put=function(b){var c;return c=e.call(this,"PUT",b||this),d(a(c))},b.prototype.$patch=function(b){var c;return c=e.call(this,"PATCH",b||this),d(a(c))},b.prototype.$setHeaders=function(a){var b,c;angular.isUndefined(this.$$headers)&&(this.$$headers={});for(b in a)c=a[b],this.$$headers[b.toUpperCase()]=c;return this},b.prototype.$setResponseInterceptor=function(a){return this.$$responseInterceptor=a,this},b.prototype.$setRequestInterceptor=function(a){return this.$$requestInterceptor=a,this},b}(),data.classname=c.name,function(a,b){var d,e;return a="/"+g(a).join("/"),d={},e={add:function(a){var b;return a=g(a),b=function(a,c){var d,e;return _.isEmpty(c)?void 0:(d=c[0],e=c.slice(1),a[d]=a[d]||{},b(a[d],e))},b(d,a,[])}},b(e),new c(a,d,void 0)}}])}).call(this);